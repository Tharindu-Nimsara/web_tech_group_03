<!DOCTYPE html>
<html>

<head>
    <title>Detail Page</title>
    <link rel="stylesheet" type="text/css" href="detail_page.css">
    <script src="detail_page.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
</head>

<body>
    <header>
        <!----left-logo and titile----->
        <div class="head">
            <img src="Images/projectShowcaselogo" alt="project-showcaseLogo" style="
            width: 35px;
            height: 35px;
            margin-right: 10px;
            border-radius: 50%;
          " />
            <div class="site-info">
                <h2>USJ Projects</h2>
                <p style="font-size: 16px">University of Sri Jayawardenepura</p>
            </div>
        </div>

        <!---centere: Navigation--->
        <nav class="nav-bar">
            <a href="index1.html">Home</a>
            <a href="gallery.html">Projects</a>
            <a href="upload.html">Upload</a>
            <a href="about.html">About</a>
        </nav>

        <!----Right search,upload button,profile---->
        <div class="search">
            <img src="Images/searchlogo" alt="searchIcon" />
            <a href="upload.html" class="upload-btn">
                <img src="Images/uploadLogo" alt="uploadIcon" />
                <span>Upload</span>
            </a>

            <div class="profile">
                <img src="Images/profile.PNG" class="profileIcon" alt="profileIcon" id="profileDropdownBtn" style="height: 40px; width: 40px; cursor: pointer;" />
                <div id="profileDropdown" style="display: none; position: absolute; right: 0; top: 50px; background: #fff; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 4px 16px rgba(0,0,0,0.12); min-width: 150px; z-index: 1000;">
                  <a href="profile.html" style="display: block; padding: 12px 20px; color: #333; text-decoration: none; border-bottom: 1px solid #eee;">Profile</a>
                  <a href="signin.html" onclick="logoutUser(event)"  style="display: block; padding: 12px 20px; color: #e53935; text-decoration: none;">Logout</a>
                </div>
            </div>
        </div>
    </header>

    <script>
      // Profile dropdown logic
      document.addEventListener('DOMContentLoaded', function() {
        var btn = document.getElementById('profileDropdownBtn');
        var dropdown = document.getElementById('profileDropdown');
        if (btn && dropdown) {
          btn.addEventListener('click', function(e) {
            e.stopPropagation();
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
          });
          document.addEventListener('click', function(e) {
            if (!dropdown.contains(e.target) && e.target !== btn) {
              dropdown.style.display = 'none';
            }
          });
        }
      });
    </script>

    <section class="section">
        <div class="performance">
            <div class="analytics">
                <h2 id="project-title">Loading project...</h2>
                <p id="project-description">Please wait while we load the project details.</p>
            </div>

            <div id="project-tags">
                <!-- Tags will be loaded dynamically -->
            </div>
            
            <br>

            <div class="project-actions" id="project-actions">
                <a href="#" class="btn btn-share" id="share-btn"><img src="Images/share-icon_861234-1151.avif" alt="" height="25px">Share</a>
                <a href="#" class="btn btn-github" id="github-btn" style="display: none;"><img src="Images/github-01.png" alt="" height="35px">GitHub</a>
                <a href="#" class="btn btn-demo" id="demo-btn" style="display: none;">Live Demo</a>
            </div>
            

            <div class="abstract" id="abstract-section" style="display: none;">
                <h2>Abstract</h2>
                <p id="project-abstract"></p>
            </div>
            

            <!-- <div class="project-files">
                <h2>Project Files</h2>
                <p>Download project documents and resources</p>

                <form class="file-list">
                    <div class="label-style"><label for="report">Project Report.pdf <button><img
                                    src="Images/download-icon.png" alt="" height="25px"> Download</button></label></div>
                    <div class="label-style"><label for="report">Project Report.pdf <button><img
                                    src="Images/download-icon.png" alt="" height="25px"> Download</button></label></div>

                    <div class="label-style"><label for="report">Project Report.pdf <button><img
                                    src="Images/download-icon.png" alt="" height="25px"> Download</button></label></div>
                    <div class="label-style"><label for="report">Project Report.pdf <button><img
                                    src="Images/download-icon.png" alt="" height="25px"> Download</button></label></div>
                    <div class="label-style"><label for="report">Project Report.pdf <button><img
                                    src="Images/download-icon.png" alt="" height="25px"> Download</button></label></div> -->

                <!-- </form>
            </div>  -->

            <!-- <div class="key-words">
                <h2>Keywords</h2>
                <button class="bttn">Education Technology</button>
                <button class="bttn">Machine Learning</button>
                <button class="bttn">Student performance</button>
                <button class="bttn">Predictive Analytics</button>
            </div> -->
        </div>


        <div class="image">
            <div class="box">
            </div>

            <div class="author">
                <h2>Author Information</h2>
                <div class="author-info">
                    <div><img src="Images/profile.PNG" alt="Author Image" class="author-image" id="author-image" /></div>
                    <div>
                        <p id="author-name">Loading...</p>
                        <p><a href="mailto:" id="author-email">Loading...</a></p>
                    </div>
                </div>
                <hr>
                <div class="author-details">
                    <p class="degree" id="author-department">Loading...</p>
                    <p class="year" id="author-year">Loading...</p>
                </div>
            </div>

            <!-- <div class="Project-Statistics">
                <h2>Project Statistics</h2>
                <p><strong>Upload Date:</strong> <span id="upload-date">-</span></p>
                <p><strong>Total Views:</strong> <span id="total-views">0</span></p>
                <p><strong>Downloads:</strong> <span id="downloads">0</span></p>
                <p><strong>Likes:</strong> <span id="likes">0</span></p>
            </div> -->
            <script>
                function uploadProject() {
                    // Show the card
                    document.getElementById('project-stats').style.display = 'block';

                    // Set today's date
                    const today = new Date();
                    const formattedDate = (today.getMonth() + 1) + '/' + today.getDate() + '/' + today.getFullYear();
                    document.getElementById('upload-date').textContent = formattedDate;

                    // Simulate random stats
                    document.getElementById('total-views').textContent = Math.floor(Math.random() * 500) + 1;
                    document.getElementById('downloads').textContent = Math.floor(Math.random() * 50) + 1;
                    document.getElementById('likes').textContent = Math.floor(Math.random() * 100) + 1;
                }
            </script>

            <!-- <div class="related-projects">
                <h2>Related Projects</h2>
                <div class="related-projects-list">
                    <div class="related-project">
                        <img src="Images/related1.jpg" alt="Related Project 1" />
                    </div>
                    <div>
                        <h3>Project Title 1</h3>
                        <p>Sanduni Fernando</p>
                        <p>Computer Science</p>
                    </div>
                </div>
                <div class="related-projects-list">
                    <div class="related-project">
                        <img src="Images/related2.jpg" alt="Related Project 2" />
                    </div>
                    <div>
                        <h3>Project Title 2</h3>
                        <p>Kavindu Fernando</p>
                        <p>Computer Science</p>
                    </div>
                </div>
                <div class="related-projects-list">
                    <div class="related-project">
                        <img src="Images/related3.jpg" alt="Related Project 3" />
                    </div>
                    <div>
                        <h3>Project Title 3</h3>
                        <p>Kasun Perera</p>
                        <p>Computer Science</p>
                    </div>
                </div>

            </div> -->
        </div>
        </div>
    </section>


    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <div class="logo-section">
                    <img src="Images/Unilogo.jpg" alt="University Logo" class="university-logo" />
                    <div class="uni">
                        <div class="uni-name">
                            <h3>USJ Student Projects</h3>
                            <p>University of Sri Jayewardenepura</p>
                        </div>
                        <div class="description">
                            A platform for students to showcase their academic projects and
                            connect with the university community.
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="gallery.html">Browse Projects</a></li>
                    <li><a href="upload.html">Upload Project</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="about.html">Contact</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h4>Support</h4>
                <ul>
                    <li><a href="about.html">Help Center</a></li>
                    <li><a href="guidelines.html">Guidelines</a></li>
                    <li><a href="privacy.html">Privacy Policy</a></li>
                    <li><a href="terms.html">Terms of Service</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>Â© 2024 University of Sri Jayewardenepura. All rights reserved.</p>
        </div>
    </footer>

    <script>
      function logoutUser(e) {
        e.preventDefault();
        fetch("http://127.0.0.1/backend/api/logout.php", {
    credentials: 'include'  
}).then(() => {
            alert("You have been logged out.");
            window.location.href = "signin.html";
          })
          .catch((err) => {
            console.error("Logout failed", err);
            alert("Logout failed.");
          });
      }

      async function checkLogin() {
        try {
          const response = await fetch("http://127.0.0.1/backend/api/is_logged_in.php", {
              credentials: 'include' 
          });
          const result = await response.json();

          if (result.status === "success") {
            // Optional: customize profile area or greet user
            console.log("User is logged in:", result.name);
          } else {
            alert("You must be logged in to view this page.");
            window.location.href = "signin.html";
          }
        } catch (error) {
          console.error("Login check failed", error);
          alert("Something went wrong. Please Login again.");
          window.location.href = "signin.html";
        }
      }

      window.onload = checkLogin;
    </script>


</body>

</html>