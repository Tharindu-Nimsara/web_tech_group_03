<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Upload Project</title>

    <!--Roboto-->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="upload.css" />
  </head>
  <body>
    <header>
      <!----left-logo and titile----->
      <div class="head">
        <img
          src="Images/projectShowcaselogo"
          alt="project-showcaseLogo"
          style="
            width: 35px;
            height: 35px;
            margin-right: 10px;
            border-radius: 50%;
          "
        />
        <div class="site-info">
          <h2>USJ Projects</h2>
          <p style="font-size: 16px">University of Sri Jayawardenepura</p>
        </div>
      </div>

      <!---centere: Navigation--->
      <nav class="nav-bar">
        <a href="index1.html">Home</a>
        <a href="gallery.html">Projects</a>
        <a href="upload.html">Upload</a>
        <a href="about.html">About</a>
      </nav>

      <!----Right search,upload button,profile---->
      <div class="search">
        <img src="Images/searchlogo" alt="searchIcon" />
        <a href="upload.html" class="upload-btn">
          <img src="Images/uploadLogo" alt="uploadIcon" />
          <span>Upload</span>
        </a>

        <div class="profile">
          <img
            src="Images/profile.PNG"
            class="profileIcon"
            alt="profileIcon"
            id="profileDropdownBtn"
            style="height: 40px; width: 40px; cursor: pointer"
          />
          <div
            id="profileDropdown"
            style="
              display: none;
              position: absolute;
              right: 0;
              top: 50px;
              background: #fff;
              border: 1px solid #ddd;
              border-radius: 8px;
              box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
              min-width: 150px;
              z-index: 1000;
            "
          >
            <a
              href="profile.html"
              style="
                display: block;
                padding: 12px 20px;
                color: #333;
                text-decoration: none;
                border-bottom: 1px solid #eee;
              "
              >Profile</a
            >
            <a
              href="signin.html"
              style="
                display: block;
                padding: 12px 20px;
                color: #e53935;
                text-decoration: none;
              "
              onclick="logoutUser(event)"
              >Logout</a
            >
          </div>
        </div>
      </div>
    </header>

    <script>
      // Profile dropdown logic
      document.addEventListener("DOMContentLoaded", function () {
        var btn = document.getElementById("profileDropdownBtn");
        var dropdown = document.getElementById("profileDropdown");
        if (btn && dropdown) {
          btn.addEventListener("click", function (e) {
            e.stopPropagation();
            dropdown.style.display =
              dropdown.style.display === "block" ? "none" : "block";
          });
          document.addEventListener("click", function (e) {
            if (!dropdown.contains(e.target) && e.target !== btn) {
              dropdown.style.display = "none";
            }
          });
        }
      });
    </script>

    <div class="content-wrapper">
      <div class="gallery-headings">
        <h1>Upload Your Project</h1>
        <p>Share your academic work with the university community</p>
      </div>

      <hr />

      <div class="partitions">
        <h2>Project Information</h2>
        <p>Provide basic details about your project</p>
        <form action="#">
          <table class="form-table">
            <tr>
              <td>
                <label for="project-title">Project Title*</label> <br />
                <input
                  type="text"
                  name="project-title"
                  class="project-title"
                  id="project-title"
                  placeholder="Enter your project title"
                  required="required"
                />
              </td>
              <td>
                <label for="author-name">Project Category*</label> <br />
                <input
                  type="text"
                  name="author-name"
                  id="project-category"
                  class="author-name"
                  placeholder="Category of your project"
                  required="required"
                />
              </td>
            </tr>
            <tr>
              <td colspan="2">
                <label for="project-desc">Project Description*</label> <br />
                <textarea
                  name="project-desc"
                  id="project-desc"
                  placeholder="Describe your project,its objectives,methodology and key findings..."
                ></textarea>
              </td>
            </tr>
            <tr>
              <td>
                <label for="department">Department*</label> <br />
                <select name="department" id="department">
                  <option value="Select-your-department" selected="selected">
                    Select your department
                  </option>
                  <option value="computer-science">Computer Science</option>
                  <option value="software-engineering">
                    Software Engineering
                  </option>
                  <option value="information-systems">
                    Information Systems
                  </option>
                </select>
              </td>
              <td>
                <label for="academic-year">Year*</label> <br />
                <input
                  type="text"
                  name="year"
                  class="project-title"
                  id="year"
                  placeholder="Year of your project"
                  required="required"
                />
              </td>
            </tr>
            <!-- <tr>
              <td>
                <label for="supervisor">Project Supervisor</label> <br />
                <input
                  type="text"
                  name="supervisor"
                  id="supervisor"
                  class="supervisor"
                  placeholder="Supervisor's name(optional) "
                />
              </td>
              <td>
                <label for="course-module">Course/Module</label> <br />
                <input
                  type="text"
                  name="course-module"
                  id="course-module"
                  class="course-module"
                  placeholder="Related course or module "
                />
              </td>
            </tr> -->
          </table>
        </form>
      </div>

      <div class="partitions">
  <h2>Project Image</h2>
  <p>Upload a representative image for your project (optional)</p>
  
  <div class="photo-upload-container">
    <div class="photo-upload-area" id="photo-upload-area">
      <div class="upload-placeholder" id="upload-placeholder">
        <img src="Images/uploadLogo" alt="Upload" style="width: 48px; height: 48px; opacity: 0.5;">
        <h4>Click to upload project image</h4>
        <p>Drag and drop an image here, or click to browse</p>
        <p style="font-size: 0.9rem; color: #666;">Supported formats: JPG, JPEG, PNG (Max 10MB)</p>
      </div>
      
      <div class="image-preview" id="image-preview" style="display: none;">
        <img id="preview-img" src="" alt="Project Preview">
        <div class="image-actions">
          <button type="button" class="change-image-btn" onclick="changeImage()">Change Image</button>
          <button type="button" class="remove-image-btn" onclick="removeImage()">Remove</button>
        </div>
      </div>
    </div>
    <input type="file" id="project-image-input" accept="image/jpeg,image/jpg,image/png" style="display: none;">
  </div>
</div>


      <div class="partitions">
        <h2>Tags</h2>
        <p>Add relevant tags to help others discover your project</p>

        <h4>Enter tags (comma separated):</h4>
        <input
          type="text"
          id="tags-input"
          name="tags"
          class="tags-input"
          placeholder="e.g. AI, Machine Learning, IoT"
          style="
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1.5px solid #e3f2fd;
            margin-bottom: 12px;
          "
        />

        <div
          id="tags-preview"
          style="margin-bottom: 10px; display: flex; flex-wrap: wrap; gap: 8px"
        ></div>
      </div>

      <!-- <div class="partitions">
        <h2>Project Files</h2>
        <p>
          Upload your project documentation,source code,presentations etc...
        </p>

        <div class="upload-partition">
          <img src="Images/uploadLogo" alt="upload-logo" />
          <h3>Upload your files</h3>
          <p>Drag and drop files here,or click or browse</p>
          <p>
            Supported formats: PDF,DOC,DOCX,PPT,PPTX,ZIP,RAR,JPG,PMG,MP4(Max
            50MB per file)
          </p>
          <a href="">Choose Files</a>
        </div>
      </div> -->

      <div class="partitions">
        <h2>Additional Information</h2>
        <p>Optionanl details about your project</p>
        <form action="#">
          <table class="form-table">
            <tr>
              <td colspan="2">
                <label for="project-abstract">Project Abstract</label> <br />
                <textarea
                  name="project-abstract"
                  id="project-abstract"
                  placeholder="Brief summary of your project (optional)"
                ></textarea>
              </td>
            </tr>
            <tr>
              <td>
                <label for="git-repo-name">GitHub Repository</label> <br />
                <input
                  type="text"
                  name="git-repo-name"
                  id="git-repo-name"
                  class="git-repo-name"
                  placeholder="https://github.com/username/repo"
                />
              </td>
              <td>
                <label for="demo-url">Live Demo URL</label> <br />
                <input
                  type="text"
                  name="demo-url"
                  id="demo-url"
                  class="demo-url"
                  placeholder="https://your-project-demo.com"
                />
              </td>
            </tr>
            <!-- <tr>
              <td colspan="2">
                <label for="keywords">Keywords</label> <br />
                <input
                  type="text"
                  name="keywords"
                  id="keywords"
                  class="keywords"
                  placeholder="Seperate keywords with commas"
                />
              </td>
            </tr> -->
          </table>
        </form>
      </div>

      <div class="buttons">
        <button class="upload-project-button" type="button">Upload Project</button>
        <!-- <a class="save-as-draft-button" href="">Save as Draft</a> -->
      </div>
    </div>

    <footer>
      <div class="footer-content">
        <div class="footer-section">
          <div class="logo-section">
            <img
              src="Images/Unilogo.jpg"
              alt="University Logo"
              class="university-logo"
            />
            <div class="uni">
              <div class="uni-name">
                <h3>USJ Student Projects</h3>
                <p>University of Sri Jayewardenepura</p>
              </div>
              <div class="description">
                A platform for students to showcase their academic projects and
                connect with the university community.
              </div>
            </div>
          </div>
        </div>

        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="gallery.html">Browse Projects</a></li>
            <li><a href="upload.html">Upload Project</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="about.html">Contact</a></li>
          </ul>
        </div>

        <div class="footer-section">
          <h4>Support</h4>
          <ul>
            <li><a href="about.html">Help Center</a></li>
            <li><a href="guidelines.html">Guidelines</a></li>
            <li><a href="privacy.html">Privacy Policy</a></li>
            <li><a href="terms.html">Terms of Service</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        <p>© 2024 University of Sri Jayewardenepura. All rights reserved.</p>
      </div>
    </footer>

    <script src="upload.js"></script>

    <script>
      function logoutUser(e) {
        e.preventDefault();
        fetch("http://127.0.0.1/backend/api/logout.php", {
          credentials: "include",
        })
          .then(() => {
            alert("You have been logged out.");
            window.location.href = "signin.html";
          })
          .catch((err) => {
            console.error("Logout failed", err);
            alert("Logout failed.");
          });
      }

      async function checkLogin() {
        try {
          const response = await fetch(
            "http://127.0.0.1/backend/api/is_logged_in.php",
            {
              credentials: "include",
            }
          );
          const result = await response.json();

          if (result.status === "success") {
            // Optional: customize profile area or greet user
            console.log("User is logged in:", result.name);
          } else {
            alert("You must be logged in to view this page.");
            window.location.href = "signin.html";
          }
        } catch (error) {
          console.error("Login check failed", error);
          alert("Something went wrong. Please Login again.");
          window.location.href = "signin.html";
        }
      }

      window.onload = checkLogin;
    </script>
  </body>
</html>
